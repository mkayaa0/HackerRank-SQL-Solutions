SELECT H.HACKER_ID, H.NAME, SUM(T.MAX_SCORE) AS TOTAL
FROM HACKERS H
JOIN (
	SELECT S.HACKER_ID, S.CHALLENGE_ID, MAX(S.SCORE) AS MAX_SCORE 
	FROM SUBMISSIONS S
    	GROUP BY S.HACKER_ID, S.CHALLENGE_ID
	) T 
	ON H.HACKER_ID = T.HACKER_ID
GROUP BY H.HACKER_ID, H.NAME
HAVING SUM(T.MAX_SCORE) > 0
ORDER BY TOTAL DESC, H.HACKER_ID ASC;