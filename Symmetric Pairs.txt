(SELECT 
    LEAST(F1.X, F1.Y) AS X,
    GREATEST(F1.X, F1.Y) AS Y
FROM FUNCTIONS F1
JOIN FUNCTIONS F2 
	ON F1.X = F2.Y AND F1.Y = F2.X
WHERE F1.X <> F1.Y
GROUP BY LEAST(F1.X, F1.Y), GREATEST(F1.X, F1.Y)
)
UNION
(
SELECT 
	X, Y
FROM FUNCTIONS
WHERE X = Y
GROUP BY X, Y
HAVING COUNT(*) > 1
)
ORDER BY X;