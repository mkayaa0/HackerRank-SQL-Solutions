SELECT W.ID, P.AGE, W.COINS_NEEDED, W.POWER
FROM  WANDS W
JOIN WANDS_PROPERTY P
	ON W.CODE = P.CODE
WHERE IS_EVIL = 0
AND W.COINS_NEEDED = (
        SELECT MIN(W2.COINS_NEEDED)
        FROM WANDS W2
        JOIN WANDS_PROPERTY WP2 
		ON W2.CODE = WP2.CODE
        WHERE 
            WP2.IS_EVIL = 0 
            AND W2.POWER = W.POWER 
            AND WP2.AGE = P.AGE
    )
ORDER BY POWER DESC, AGE DESC;